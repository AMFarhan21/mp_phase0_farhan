<!DOCTYPE html>
<html>

<head>
    <title>Valorant Boosting</title>
    <!-- Tailwind -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-black font-mono w-screen min-h-screen flex flex-col text-white">
    <!-- HEADER -->
    <header class="w-full text-white p-4 text-sm md:text-base fixed z-10 bg-black/20">
        <div class="mx-auto flex justify-between items-center max-w-[1200px] w-full">
            <div class="flex flex-wrap justify-center items-center cursor-pointer">
                <img src="./images/valorant.webp" class="w-8" />
                <a href="./home.html">
                    <h1 class="text-lg md:text-3xl font-bold">ValBoost</h1>
                </a>
            </div>
            <ul class="flex flex-wrap gap-2 md:gap-6 ml-auto">
                <li><a href="./home.html"
                        class="list-none hover:bg-white hover:text-black p-2 md:px-4 md:py-2 rounded-lg cursor-pointer">Home</a>
                </li>
                <li><a href="./services.html"
                        class="list-none hover:bg-white hover:text-black p-2 md:px-4 md:py-2 rounded-lg cursor-pointer">Services</a>
                </li>
                <li><a href="./portfolio.html"
                        class="list-none hover:bg-white hover:text-black p-2 md:px-4 md:py-2 rounded-lg cursor-pointer">Portfolio</a>
                </li>
                <li><a href="./about.html"
                        class="list-none hover:bg-white hover:text-black p-2 md:px-4 md:py-2 rounded-lg cursor-pointer">About
                        Us</a>
                </li>
                <li><a href="./contact.html"
                        class="list-none hover:bg-white hover:text-black p-2 md:px-4 md:py-2 rounded-lg cursor-pointer">Contact
                        Us</a></li>
                <li><a href="./login.html"
                        class="list-none hover:bg-white/80 bg-white text-black  p-2 md:px-4 md:py-2 rounded-lg cursor-pointer"
                        id="login">Login</a>
                </li>
            </ul>
        </div>
    </header>

    <!-- BODY -->
    <main
        class="text-white w-full h-full justify-center flex flex-col items-center bg-[url(./images/valorantWallpaper6.jpg)] bg-center bg-cover relative z-1">
        <form onsubmit="contact(event)" id="form"
            class="z-10 mt-20 mx-auto justify-between items-center max-w-[600px] w-full bg-white text-black p-4 rounded-xl space-y-4 drop-shadow-[0_0_16px_rgba(255,255,255,0.8)]">
            <h1 class="font-bold text-4xl text-center">Contact Us</h1>
            <div id="input_container" class="space-y-4">
                <input id="name" type="text" placeholder="Name"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" />
                <input id="email" type="text" placeholder="Email" class="border-b-1 focus:outline-none px-4 py-1 w-full"
                    required />
                <input id="subject" type="text" placeholder="Subject"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" required />
                <textarea id="message" type="text" placeholder="Message"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" rows="3" required></textarea>
            </div>
            <button type="submit"
                class="bg-red-600 px-6 py-2 rounded-lg text-white w-full cursor-pointer">Submit</button>
        </form>
        <form onsubmit="submitUpdate(event)" id="update_modal"
            class="hidden fixed z-50 border-1 inset-0 mt-20 mx-auto justify-between items-center max-w-[600px] w-full h-110 bg-white text-black p-4 rounded-xl space-y-4 drop-shadow-[0_0_16px_black]">
            <button onclick="closeModal()" class="text-red-600 text-2xl font-bold cursor-pointer">X</button>
            <h1 class="font-bold text-4xl text-center">Update Contact Message</h1>
            <div id="input_container" class="space-y-4">
                <input id="update_name" type="text" placeholder="Name"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" />
                <input id="update_email" type="text" placeholder="Email"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" required />
                <input id="update_subject" type="text" placeholder="Subject"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" required />
                <textarea id="update_message" type="text" placeholder="Message"
                    class="border-b-1 focus:outline-none px-4 py-1 w-full" rows="3" required></textarea>
            </div>
            <button type="submit"
                class="bg-red-600 px-6 py-2 rounded-lg text-white w-full cursor-pointer">Submit</button>
        </form>
        <table
            class="z-10 mx-auto justify-between items-center max-w-[1200px] mb-8 w-full bg-white text-black rounded-xl space-y-4 drop-shadow-[0_0_16px_rgba(255,255,255,0.8)]">
            >
            <thead>
                <tr>
                    <th class="border-l border-gray-400 px-4 py-2">Id</th>
                    <th class="border-l border-gray-400 px-4 py-2">Name</th>
                    <th class="border-l border-gray-400 px-4 py-2">Email</th>
                    <th class="border-l border-gray-400 px-4 py-2">Subject</th>
                    <th class="border-l border-gray-400 px-4 py-2">Message</th>
                    <th class="border-l border-gray-400 px-4 py-2">Action</th>
                </tr>
            </thead>
            <tbody id="tbody">

            </tbody>
        </table>
        <div class="absolute inset-0 bg-black/60 z-0"></div>
    </main>

    <!-- FOOTER -->
    <footer>
        <div
            class="mx-auto justify-between max-w-[1200px] w-full p-6 md:p-12 space-y-4 gap-4 grid md:grid-cols-3 grid-cols-1 ">
            <div class="border-b-1 md:border-b-0 pb-4 md:border-r-1 md:pr-4 md:mr-4 space-y-2">
                <div class="flex items-center">
                    <img src="./images/valorant.webp" class="w-8" />
                    <h4 class="text-xl md:text-3xl font-bold">ValBoost</h4>
                </div>
                <p class="text-sm md:text-base text-white/60 text-justify">
                    ValBoost isnt endorsed or in any way affiliated with Riot Games. All trademarks and logos belong
                    to their respective owners. All submitted art content remains copyright of its original copyright
                    holder.
                </p>
                <p class="text-white/60">&copy; 2025 ValBoost.com | All Rights Reserved</p>
            </div>
            <div class="border-b-1 md:border-b-0 pb-4 md:border-r-1 md:pr-4 md:mr-4 space-y-2">
                <h4 class="text-xl md:text-3xl font-bold">Quick Links</h4>
                <ul class="text-sm md:text-base text-white/60 list-disc">
                    <li><a href="./home.html" class="hover:bg-white hover:text-black">Home</a>
                    </li>
                    <li><a href="./services.html" class="hover:bg-white hover:text-black">Services</a>
                    </li>
                    <li><a href="./portfolio.html" class="hover:bg-white hover:text-black">Portfolio</a>
                    </li>
                    <li><a href="./about.html" class="hover:bg-white hover:text-black">About
                            Us</a>
                    </li>
                    <li><a href="./contact.html" class="hover:bg-white hover:text-black">Contact
                            Us</a></li>
                    </li>

                </ul>
            </div>
            <div class="space-y-2">
                <h4 class="text-xl md:text-3xl font-bold">Got Any Questions?</h4>
                <p class="text-sm md:text-base text-white/60 text-justify">We have a dedicated team of customer service
                    representatives to
                    help you with
                    any questions.
                </p>
                <a href="./contact.html"
                    class="bg-white text-black text-xl rounded-lg px-6 py-2 font-bold cursor-pointer hover:bg-white/80">Contact
                    Us
                </a>
            </div>
        </div>
    </footer>
    <script>
        const login = document.getElementById("login");

        const status = sessionStorage.getItem("session");
        if (status) {
            login.innerHTML = "Logout"
            login.addEventListener("click", (e) => {
                e.preventDefault()
                if (confirm("Are you sure you want to logout?")) {
                    sessionStorage.removeItem("session")
                    login.innerHTML = "Login"
                    window.location.reload()
                }
            })
        }


        async function contact(e) {
            e.preventDefault()

            try {
                const name = document.getElementById("name").value;
                const email = document.getElementById("email").value;
                const subject = document.getElementById("subject").value;
                const message = document.getElementById("message").value;

                const response = await fetch("http://localhost:3000/contact", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ name, email, subject, message })
                })

                const result = await response.json()

                if (result.success) {
                    alert(result.message)
                    window.location.reload()
                } else {
                    console.log(result.error)
                    alert(result.error)
                }


            } catch (error) {
                console.error("ERROR on contact function: ", error)
            }
        }


        async function getContact() {
            try {
                const response = await fetch("http://localhost:3000/contact")
                const result = await response.json()

                const tbody = document.getElementById("tbody")

                for (let data of result) {


                    let row = document.createElement('tr')
                    row.innerHTML = `
                        <td class="border border-gray-400 px-4 py-2">${data.id}</td>
                        <td class="border border-gray-400 px-4 py-2">${data.name}</td>
                        <td class="border border-gray-400 px-4 py-2">${data.email}</td>
                        <td class="border border-gray-400 px-4 py-2">${data.subject}</td>
                        <td class="border border-gray-400 px-4 py-2">${data.message}</td>
                        <td class="border-t border-gray-400 px-4 py-2 flex gap-2">
                            <button onclick="deleteContact(${data.id})" class="bg-red-400 rounded-xl p-2 cursor-pointer">🗑️</button>
                            <button onclick="updateModal(${data.id}, '${data.name}', '${data.email}', '${data.subject}', '${data.message}')" class="bg-blue-400 rounded-xl p-2 cursor-pointer">✍️</button>
                        </td>
                    `
                    tbody.appendChild(row)
                }

            } catch (error) {
                console.error("ERROR on getContact function: ", error)
            }
        }

        async function deleteContact(id) {
            try {
                if (confirm("Are you sure you want to delete this message?")) {
                    const response = await fetch(`http://localhost:3000/contact/${id}`, {
                        method: "DELETE"
                    })
                    const result = await response.json()
                    if (result.success) {
                        alert(result.message)
                        window.location.reload()
                    } else {
                        console.log(result.message)
                    }
                }
            } catch (error) {
                console.error("ERROR on deleteContact function: ", error)
            }
        }

        const update_modal = document.getElementById("update_modal");

        let current_id = null;

        async function updateModal(id, name, email, subject, message) {
            update_modal.classList.remove("hidden")
            current_id = id;

            document.getElementById("update_name").value = name
            document.getElementById("update_email").value = email
            document.getElementById("update_subject").value = subject
            document.getElementById("update_message").value = message

        }

        async function closeModal() {
            update_modal.classList.add("hidden")
        }

        async function submitUpdate(e) {
            e.preventDefault()
            const name = document.getElementById("update_name").value;
            const email = document.getElementById("update_email").value;
            const subject = document.getElementById("update_subject").value;
            const message = document.getElementById("update_message").value;

            try {
                const response = await fetch(`http://localhost:3000/contact/${current_id}`, {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ name, email, subject, message })
                })

                const result = await response.json()

                if (result.success) {
                    alert("Contact message updated successfully");
                    closeModal
                    window.location.reload()
                } else {
                    console.error(result.error)
                }
            } catch (error) {
                console.error("ERROR on submitUpdate() function: ", error)
            }
        }

        getContact()
    </script>
</body>

</html>